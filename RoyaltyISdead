if _G.LinoriaGui then
    _G.LinoriaGui:Destroy()
    _G.LinoriaGui = nil
end

local repo    = "https://raw.githubusercontent.com/violin-suzutsuki/LinoriaLib/main/"
local Library = loadstring(game:HttpGet(repo.."Library.lua"))()
local Theme   = loadstring(game:HttpGet(repo.."addons/ThemeManager.lua"))()
local Save    = loadstring(game:HttpGet(repo.."addons/SaveManager.lua"))()

local W       = Library:CreateWindow({Title="Rise to Destruction - By Demon8989_19",Center=true,AutoShow=true})
_G.LinoriaGui = Library.ScreenGui

local T       = W:AddTab("Main")
local F       = T:AddLeftGroupbox("Food")
local D       = T:AddLeftGroupbox("Drinks")
local S       = T:AddLeftGroupbox("Desserts")

local Rtab    = W:AddTab("Resources")
local ResGB   = Rtab:AddLeftGroupbox("Resources")
local MedGB   = Rtab:AddLeftGroupbox("Medicine")

local ToolTab = W:AddTab("Tools")
local X       = ToolTab:AddLeftGroupbox("Tools")

F:AddButton("Cinnamon Bread",function()
    local args={workspace.World.Interactables.Stores.BreadStall,"Cinnamon Bread"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
F:AddButton("Cooked Bread",function()
    local args={workspace.World.Interactables.Stores.BreadStall,"Cooked Bread"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
F:AddButton("Bread",function()
    local args={workspace.World.Interactables.Stores.BreadStall,"Bread"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)

D:AddButton("Grape Juice",function()
    local args={workspace.World.Interactables.Stores.DrinkStall,"Grape Juice"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
D:AddButton("Orange Juice",function()
    local args={workspace.World.Interactables.Stores.DrinkStall,"Orange Juice"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
D:AddButton("Apple Juice",function()
    local args={workspace.World.Interactables.Stores.DrinkStall,"Apple Juice"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)

S:AddButton("Tart",function()
    local args={workspace.World.Interactables.Stores.DessertStall,"Tart"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
S:AddButton("Pie",function()
    local args={workspace.World.Interactables.Stores.DessertStall,"Pie"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
S:AddButton("Red Velvet Cake",function()
    local args={workspace.World.Interactables.Stores.DessertStall,"Red Velvet Cake"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
S:AddButton("Strawberry Cake",function()
    local args={workspace.World.Interactables.Stores.DessertStall,"Strawberry Cake"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
S:AddButton("Chocolate Cake",function()
    local args={workspace.World.Interactables.Stores.DessertStall,"Chocolate Cake"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)

ResGB:AddButton("Powder",function()
    local args={workspace.World.Interactables.Stores.ResourceStall,"Powder"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
ResGB:AddButton("Mint",function()
    local args={workspace.World.Interactables.Stores.ResourceStall,"Mint"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)

MedGB:AddButton("Saffron",function()
    local args={workspace.World.Interactables.Stores.MedicineStall,"Saffron"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
MedGB:AddButton("Honey",function()
    local args={workspace.World.Interactables.Stores.MedicineStall,"Honey"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)
MedGB:AddButton("Tea",function()
    local args={workspace.World.Interactables.Stores.MedicineStall,"Tea"}
    game.ReplicatedStorage.Packages.Knit.Services.StallService.RE.Event:FireServer(unpack(args))
end)

X:AddButton("Instant Prompt",function()
    local function I(p) if p:IsA("ProximityPrompt") then p.HoldDuration=0 end end
    for _,v in pairs(game:GetDescendants()) do I(v) end
    game.DescendantAdded:Connect(I)
end)

X:AddButton("Infinite Yield", function()
    loadstring(game:HttpGet(('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source'),true))()
end)

X:AddToggle('FindRosaline',{Text='Find Rosaline',Default=false,Tooltip='Toggle highlight on Rosaline'}):OnChanged(function(value)
    local npc=workspace:WaitForChild("World"):WaitForChild("Interactables"):WaitForChild("SpecialNPCs"):WaitForChild("Rosaline")
    local existing=npc:FindFirstChild("RosalineHighlight")
    if value then
        if not existing then
            local h=Instance.new("Highlight")
            h.Name="RosalineHighlight"
            h.Adornee=npc
            h.FillColor=Color3.fromRGB(255,0,0)
            h.OutlineColor=Color3.fromRGB(255,255,255)
            h.FillTransparency=0.5
            h.OutlineTransparency=0
            h.Parent=npc
        end
    else
        if existing then existing:Destroy() end
    end
end)

-- UI Settings Tab (moved to end)
Theme:SetLibrary(Library)
Theme:ApplyToTab(W:AddTab("UI Settings"))

Save:SetLibrary(Library)
Save:ApplyToWindow(W)
